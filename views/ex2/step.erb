<%
  part2 ||= false
%>
<style>
.main {
  text-align: center;
  /*border:1px solid red;*/
}
.noDisplay {
  display: none
}
.main .btn {
  height:200px;
  width:200px;
  margin:40px 100px;
  font-size:45px;  
  color: grey !important;
  font-weight: bold;
}
.main .btn.black {
  color: black !important;
}
.grey {
  color: grey !important;
}
.disabled {
  pointer-events: none;
  cursor: wait !important;
}
.invisible {
  visibility: none;
}
.guess_area {
  margin:auto 50px;
  float:left;
}
</style>
<div class='main'>
  <% if part2 %>
    <h5>Part 2</h5>
  <% else %>
    <h5>Part 1</h5>
  <% end %>
  <h4> Trial <span class='stepNum'>1</span></h4>
  <div class='even_odd_trials invisible'>
    <button class='btn btn-lg btn-info btn-raised btn-left' style='background-color: <%=sesh[:colors][0]%>' onclick=buttonClick(this,'left')></button>
    <button class='btn btn-lg btn-warning btn-raised btn-right' style='background-color: <%=sesh[:colors][1]%>' onclick=buttonClick(this,'right')></button>
  </div>
  <div class='even_odd_trials'>
    <button class='btn btn-lg btn-info btn-raised btn-left' style='background-color: <%=sesh[:colors][2]%>' onclick=buttonClick(this,'left')></button>
    <button class='btn btn-lg btn-warning btn-raised btn-right' style='background-color: <%=sesh[:colors][3]%>' onclick=buttonClick(this,'right')></button>
  </div>
  <div>Admin Data: <%= sesh.to_h %></div>
  <div>
  <% if false %>
  <span class='guess_area'>
    <span class='guess_text'>What do you think is your chance of getting this right? </span>
    <div>
    <input />
    </div>
  </span>
  </div>

<% end %>

</div>

<script>
var stepNum = 1; 
function enableButtons(){
  $('.btn').removeClass('black').removeClass('grey').removeClass('disabled').text('');
  $('.stepNum').text(stepNum);
  $('.even_odd_trials').toggleClass('invisible')
}
function buttonClick(btn,side) {
  if (side == 'left') other = 'right';
  if (side == 'right') other = 'left';
  $.get(`/ex2/click?side=${side}&stepNum=${stepNum}&part2=${<%=part2%>}`).success(res=>{    
    $('.btn-'+side).addClass('black').text(res[side])
    $('.btn-'+other).addClass('grey').text(res[other])
    $('.btn').addClass('disabled');
    stepNum = res.stepNum;    
    var waitTime = 1000
    setTimeout(enableButtons,waitTime);

    if (res.gotoPart2) setTimeout(()=>document.location.href = '/ex2/instructions_part2',waitTime);
    if (res.done) setTimeout(()=>document.location.href = '/ex2/done',waitTime);
  })
}
</script>